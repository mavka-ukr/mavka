взяти означення ./Шлях;
взяти означення ./Інформація;

простір біб {
  структура Файл;
}

зовнішня дія __біб__відкрити_файл(шлях: адреса<біб::Шлях>, створити_якщо_не_існує: логічне, вихід: адреса<адреса<біб::Файл>>) -> ціле;
зовнішня дія __біб__відкрити_файл_для_перезапису(шлях: адреса<біб::Шлях>, створити_якщо_не_існує: логічне, вихід: адреса<адреса<біб::Файл>>) -> ціле;
зовнішня дія __біб__закрити_файл(файл: адреса<біб::Файл>) -> ціле;
зовнішня дія __біб__прочитати_файл_повністю(файл: адреса<біб::Файл>, вихід: адреса<біб::Інформація>) -> ціле;
зовнішня дія __біб__прочитати_частину_файлу(файл: адреса<біб::Файл>, початок: природне, розмір: природне, дані: памʼять<п8>) -> ціле;
зовнішня дія __біб__записати_файл(файл: адреса<біб::Файл>, розмір: природне, дані: памʼять<п8>) -> ціле;

простір біб {
  // відкриває файл для читання і запису
  // створення файлу відбувається з доступом на читання і запис для власника і читання для інших
  дія відкрити_файл(шлях: Шлях, створити_якщо_не_існує: логічне, вихід: адреса<адреса<Файл>>) -> ціле {
    вернути __біб__відкрити_файл(шлях::адреса, створити_якщо_не_існує, вихід);
  }

  // відкриває файл для перезапису
  // створення файлу відбувається з доступом на читання і запис для власника і читання для інших
  дія відкрити_файл_для_перезапису(шлях: Шлях, створити_якщо_не_існує: логічне, вихід: адреса<адреса<Файл>>) -> ціле {
    вернути __біб__відкрити_файл_для_перезапису(шлях::адреса, створити_якщо_не_існує, вихід);
  }

  дія закрити_файл(файл: адреса<Файл>) {
    __біб__закрити_файл(файл);
  }

  дія прочитати_файл_повністю(файл: адреса<Файл>, вихід: адреса<Інформація>) -> ціле {
    вернути __біб__прочитати_файл_повністю(файл, вихід);
  }

  дія прочитати_частину_файлу(файл: адреса<Файл>, початок: природне, розмір: природне, дані: памʼять<п8>) -> ціле {
    вернути __біб__прочитати_частину_файлу(файл, початок, розмір, дані);
  }

  дія записати_файл(файл: адреса<Файл>, розмір: природне, дані: памʼять<п8>) -> ціле {
    вернути __біб__записати_файл(файл, розмір, дані);
  }

  дія прочитати_файл_за_шляхом(шлях: Шлях, вихід: адреса<Інформація>) -> ціле {
    змінна файл: адреса<Файл>;
    змінна результат: ціле;

    результат = __біб__відкрити_файл(шлях::адреса, ні, файл::адреса);
    якщо результат < 0 {
      вернути результат;
    }
    
    результат = __біб__прочитати_файл_повністю(файл, вихід);
    
    __біб__закрити_файл(файл);
  
    вернути результат;
  }

  дія записати_файл_за_шляхом(шлях: Шлях, розмір: природне, дані: памʼять<п8>) -> ціле {
    змінна файл: адреса<Файл>;
    змінна результат: ціле;

    результат = __біб__відкрити_файл(шлях::адреса, так, файл::адреса);
    якщо результат < 0 {
      вернути результат;
    }
    
    результат = __біб__записати_файл(файл, розмір, дані);
    
    __біб__закрити_файл(файл);
  
    вернути результат;
  }

  дія перезаписати_файл_за_шляхом(шлях: Шлях, розмір: природне, дані: памʼять<п8>) -> ціле {
    змінна файл: адреса<Файл>;
    змінна результат: ціле;

    результат = __біб__відкрити_файл_для_перезапису(шлях::адреса, так, файл::адреса);
    якщо результат < 0 {
      вернути результат;
    }
    
    результат = __біб__записати_файл(файл, розмір, дані);
    
    __біб__закрити_файл(файл);
  
    вернути результат;
  }
}