взяти біб інтернет
взяти біб планувальник

дія обробити_дані_звʼязку(звʼязок, дані)
  вивести("отримано", юнікод(дані))
кінець

дія обробити_закінчення_звʼязку(звʼязок, помилка)
  друк("закінчено")
кінець

дія обробити_відключення_звʼязку(звʼязок, помилка)
  планувальник.скасувати_періодичне(звʼязок.користувацькі_дані)

  якщо помилка
    друк("відключено з помилкою", помилка)
  інакше
    друк("відключено")
  кінець
кінець

дія обробити_підключення_звʼязку(звʼязок, помилка)
  якщо помилка
    друк("помилка підключення", помилка)
  інакше
    друк("підключено", звʼязок)

    звʼязок.обробник_даних = обробити_дані_звʼязку
    звʼязок.обробник_закінчення = обробити_закінчення_звʼязку
    звʼязок.обробник_відключення = обробити_відключення_звʼязку

    інтернет.надіслати(ю"привіт\n", звʼязок)
    вивести("надіслано", ю"привіт\n")

    звʼязок.користувацькі_дані = планувальник.періодично(дія()
      інтернет.надіслати(ю"період\n", звʼязок)
      вивести("надіслано", ю"період\n")
    кінець, 1000)
  кінець
кінець

інтернет.звʼязатись(
  "0.0.0.0",
  8080,
  обробити_підключення_звʼязку
)
