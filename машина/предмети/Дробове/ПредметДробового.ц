взяти означення мавка/машина;

простір мавка {
  місцева дія записати_метод_структури_Дробове__чародія_ціле(М: адреса<Машина>);
  місцева дія записати_метод_структури_Дробове__чародія_дробове(М: адреса<Машина>);
  місцева дія записати_метод_структури_Дробове__чародія_текст(М: адреса<Машина>);

  дія рідна_дія__з(
    М: адреса<Машина>,
    здійснювач: адреса<Предмет>,
    предмет_дії: адреса<ПредметДії>,
    задіяні: Задіяні
  ) -> ПредметАбоСтанПадіння {
    змінна задіяне_значення: адреса<Предмет> = пусто;

    знайти_задіяне(М, задіяні, 0, М.константи_назв._значення, задіяне_значення::адреса);

    якщо задіяне_значення == пусто {
      вернути створити_дробове_з_д64(М, 0.0) як адреса<Предмет>;
    }

    якщо задіяне_значення == М.значення_дійсне {
      вернути створити_дробове_з_д64(М, 1.0) як адреса<Предмет>;
    }

    вернути здійснити_властивість(
      М,
      задіяне_значення,
      М.константи_назв._чародія_дробове,
      Задіяні { 0, пусто, пусто },
      Місцезнаходження { пусто, 0 }
    );
  }

  дія записати_дію__з(М: адреса<Машина>) {
    змінна предмет_дії = створити_рідну_дію(
      М,
      М.константи_назв._з,
      М.предмет_пустої_послідовності як адреса<ПредметПослідовності>,
      пусто,
      рідна_дія__з,
      пусто
    );

    предмет_структури_змінити_властивість(
      М,
      М.предмет_структури_Дробове,
      М.константи_назв._з,
      предмет_дії як адреса<Предмет>,
      Місцезнаходження { пусто, 0 }
    );

    якщо М.стан_падіння {
      запанікувати(М, "Помилка при записі дії \"з\" для структури \"Дробове\".");
    }
  }
}

простір мавка {
  місцева дія заповнити_структуру_Дробове(
    М: адреса<Машина>
  ) {
    М.предмет_структури_Дробове.заборонити_наслідування = так;

    записати_метод_структури_Дробове__чародія_ціле(М);
    записати_метод_структури_Дробове__чародія_дробове(М);
    записати_метод_структури_Дробове__чародія_текст(М);

    записати_дію__з(М);
  }

  місцева дія створити_дробове_з_д64(
    М: адреса<Машина>,
    значення: д64
  ) -> адреса<ПредметДробового> {
    змінна предмет = виділити_предмет<ПредметДробового>(М, М.предмет_структури_Дробове);
    предмет.значення = значення;

    вернути предмет;
  }

  місцева дія предмет_дробового_додати(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_дробове_з_д64(М, значення.значення + д64((право як адреса<ПредметЦілого>).значення)) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_дробове_з_д64(М, значення.значення + (право як адреса<ПредметДробового>).значення) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Додати до дробового числа можна лише або ціле або дробове число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_відняти(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_дробове_з_д64(М, значення.значення - д64((право як адреса<ПредметЦілого>).значення)) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_дробове_з_д64(М, значення.значення - (право як адреса<ПредметДробового>).значення) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Відняти від дробового числа можна лише або ціле або дробове число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_помножити(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_дробове_з_д64(М, значення.значення * д64((право як адреса<ПредметЦілого>).значення)) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_дробове_з_д64(М, значення.значення * (право як адреса<ПредметДробового>).значення) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Помножити дробове число можна лише на або ціле або дробове число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_поділити(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_дробове_з_д64(М, значення.значення / д64((право як адреса<ПредметЦілого>).значення)) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_дробове_з_д64(М, значення.значення / (право як адреса<ПредметДробового>).значення) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Поділити дробове число можна лише на або ціле або дробове число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_остача(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_дробове_з_д64(М, значення.значення % д64((право як адреса<ПредметЦілого>).значення)) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_дробове_з_д64(М, значення.значення % (право як адреса<ПредметДробового>).значення) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Отримати остачу ділення дробового числа можна лише з або цілим або дробовим число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_поділити_націло(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_ціле_з_ц64(М, ц64(значення.значення) / (право як адреса<ПредметЦілого>).значення) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_ціле_з_ц64(М, ц64(значення.значення) / ц64((право як адреса<ПредметДробового>).значення)) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Отримати неповну частку ділення дробового числа можна лише з або цілим або дробовим число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_степінь(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      вернути створити_дробове_з_д64(М, піднести_до_степеня_д64(М, значення.значення, д64((право як адреса<ПредметЦілого>).значення))) як адреса<Предмет>;
    }

    якщо право.тип == М.предмет_структури_Дробове {
      вернути створити_дробове_з_д64(М, піднести_до_степеня_д64(М, значення.значення, (право як адреса<ПредметДробового>).значення)) як адреса<Предмет>;
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Отримати степінь дробового числа можна лише з або цілим або дробовим число.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_менше(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      якщо значення.значення < д64((право як адреса<ПредметЦілого>).значення) {
        вернути М.значення_дійсне;
      } інакше {
        вернути пусто;
      }
    }

    якщо право.тип == М.предмет_структури_Дробове {
      якщо значення.значення < (право як адреса<ПредметДробового>).значення {
        вернути М.значення_дійсне;
      } інакше {
        вернути пусто;
      }
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Виконути перевірку чи дробове число менше можна з цілим або дробовим числом.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_більше(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    право: адреса<Предмет>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    якщо право.тип == М.предмет_структури_Ціле {
      якщо значення.значення > д64((право як адреса<ПредметЦілого>).значення) {
        вернути М.значення_дійсне;
      } інакше {
        вернути пусто;
      }
    }

    якщо право.тип == М.предмет_структури_Дробове {
      якщо значення.значення > (право як адреса<ПредметДробового>).значення {
        вернути М.значення_дійсне;
      } інакше {
        вернути пусто;
      }
    }

    увімкнути_стан_падіння(
      М,
      створити_текст(М, "Виконути перевірку чи дробове число менше можна з цілим або дробовим числом.") як адреса<Предмет>,
      місцезнаходження
    );
    вернути пусто;
  }

  місцева дія предмет_дробового_змінити_знак(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    вернути створити_дробове_з_д64(М, -значення.значення) як адреса<Предмет>;
  }

  місцева дія предмет_дробового_отримати_властивість(
    М: адреса<Машина>,
    значення: адреса<ПредметДробового>,
    назва: адреса<ПредметТексту>,
    місцезнаходження: Місцезнаходження
  ) -> ПредметАбоСтанПадіння {
    змінна предмет_методу = знайти_метод_в_структурі(
      М,
      М.предмет_структури_Дробове,
      назва
    );

    якщо предмет_методу == пусто {
      вернути пусто;
    }

    вернути предмет_методу як адреса<Предмет>;
  }
}