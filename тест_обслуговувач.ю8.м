взяти біб інтернет

підключені_клієнти = []

дія обробити_зупинку(обслуговувач, помилка)
  друк("Обслуговувач зупинено!")
кінець

дія обробити_підключення(обслуговувач, клієнт, адреса, порт)
  друк("підключення", клієнт, адреса, порт)
  підключені_клієнти.додати(клієнт)
кінець

дія обробити_відключення(обслуговувач, клієнт)
  друк("відключення", клієнт)
  підключені_клієнти := підключені_клієнти.фільтрувати(
    дія(підключений_клієнт): підключений_клієнт != клієнт
  )
кінець

дія обробити_повідомлення(обслуговувач, клієнт, повідомлення)
  друк("повідомлення", клієнт, повідомлення)

  впасти "ой..."

  перебрати підключені_клієнти як підключений_клієнт
    обслуговувач.надіслати(підключений_клієнт, повідомлення)
  кінець
кінець

обслуговувач = інтернет.створити_обслуговувач("0.0.0.0", 8080)

друк(обслуговувач)

обслуговувач.обробник_зупинки = обробити_зупинку
обслуговувач.обробник_підключення = обробити_підключення
обслуговувач.обробник_відключення = обробити_відключення
обслуговувач.обробник_повідомлення = обробити_повідомлення

обслуговувач.запустити(
  дія(обслуговувач, помилка)
    якщо помилка
      друк("Помилка запуску обслуговувача: ", помилка)
    інакше
      друк("Обслуговувач запущено!")
    кінець
  кінець
)